# Создание крипто-материалов для Hyperledger Fabric


## Создания крипто-метериалов при использовании docker
1) Скопировать директорию `fabric`
2) Установить ограничение к директории криптоматериалов (указывается в `MOUNT_DIR`)
3) В файле `project.properties` указать необходимые данные (описание в файле)
4) `./start-ca.sh` запустить удостоверяющие центры
5) `./enroll.sh` сгенерировать криптоматериалы
6) `./start-ca.sh` остановить удостоверяющие центры
7) Криптоматериалы будут в директории: `${MOUNT_DIR}/${__CRYPTO_NAME__}`

дополнительно: 

`./hsm-list.sh` - список записей в hsm

--
деструктивные операции (clear) по умолчанию отключены
для включения в файле `` установить значение переменной `PRODUCTION=off`
--
логи серверов удостоверяющих центров: 
значения в переменных `__TLSCA_LOG__` и `__CA_LOG__` 
--

## Для разработки при использовании docker
## Создания крипто-метериалов
## Общие действия для создания крипто-метериалов

1) Собрать образ build
2) make start-ca - запустить контейнер с удостоверяющими центрами (ca, tlsca)


## Первичное создание крипто-материалов
3) `./enroll.sh`


## Перевыпуск крипто-материалов
3) `./reenroll.sh`


4) Скопировать крипто-материалы из контейнера в директорию ./crypto,
`./copy-crypto.sh`

--------
# Первичная установка:

Создать docker volume для хранения постоянных данных crypto генератора
docker volume create --driver local afsc-fabric-crypto-db


